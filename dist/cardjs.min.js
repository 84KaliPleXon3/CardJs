!function($){function initCardNumberInput(){cardNumberInput=displayElement.find(".card-number"),cardNumberInput.attr("type","tel"),cardNumberInput.attr("placeholder")||cardNumberInput.attr("placeholder",settings.creditCardNumberPlaceholder),cardNumberInput.attr("maxlength",settings.creditCardNumberMask.length),cardNumberInput.attr("x-autocompletetype","cc-number"),cardNumberInput.attr("autocompletetype","cc-number"),cardNumberInput.attr("autocorrect","off"),cardNumberInput.attr("spellcheck","off"),cardNumberInput.attr("autocapitalize","off"),cardNumberInput.keydown(handleCreditCardNumberKey),cardNumberInput.keyup(refreshCreditCardTypeIcon),cardNumberInput.change(handleCreditCardNumberChange)}function setupCardNumberInput(){displayElement.append("<div class='card-number-wrapper'></div>");var wrapper=displayElement.find(".card-number-wrapper");wrapper.append(cardNumberInput),wrapper.append("<div class='card-type-icon'></div>"),wrapper.append("<div class='icon'></div>")}function clearCardTypeIcon(){displayElement.find(".card-number-wrapper .card-type-icon").attr("class","card-type-icon")}function setCardTypeIconAsVisa(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon visa")}function setCardTypeIconAsMasterCard(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon master-card")}function setCardTypeIconAsAmericanExpress(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon american-express")}function setCardTypeIconAsDiscover(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon discover")}function setCardTypeIconAsDiners(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon diners")}function setCardTypeIconAsJcb(){var cardTypeIcon=displayElement.find(".card-number-wrapper .card-type-icon");cardTypeIcon.attr("class","card-type-icon jcb")}function handleNumberOnlyKey(e){var keyCode=e.which||e.keyCode,isNumber=keyCode>=KEY_0&&KEY_9>=keyCode,isDeletion=keyCode==KEY_BACKSPACE||keyCode==KEY_DELETE,isArrow=keyCode>=KEY_ARROW_LEFT&&KEY_ARROW_DOWN>=keyCode,isNavigation=keyCode==KEY_HOME||keyCode==KEY_END,isKeyboardCommand=e.ctrlKey&&(keyCode==KEY_A||keyCode==KEY_X||keyCode==KEY_C||keyCode==KEY_V);isNumber||isDeletion||isArrow||isNavigation||isKeyboardCommand||e.preventDefault()}function numbersOnlyString(string){for(var numbersOnlyString="",i=0;i<string.length;i++){var currentChar=string.charAt(i),isValid=!isNaN(parseInt(currentChar));isValid&&(numbersOnlyString+=currentChar)}return numbersOnlyString}function applyFormatMask(string,mask){for(var formattedString="",numberPos=0,j=0;j<mask.length;j++){var currentMaskChar=mask[j];if("X"==currentMaskChar?(formattedString+=string.charAt(numberPos),numberPos++):formattedString+=currentMaskChar,numberPos>=string.length)break}return formattedString}function refreshCreditCardTypeIcon(){setCardTypeIconFromNumber(numbersOnlyString(cardNumberInput.val()))}function handleCreditCardNumberKey(e){handleNumberOnlyKey(e);var keyCode=e.which||e.keyCode,char=String.fromCharCode(keyCode);if(!isNaN(parseInt(char))){e.preventDefault();var numbersOnly=numbersOnlyString(cardNumberInput.val())+char,formatted=applyFormatMask(numbersOnly,settings.creditCardNumberMask);$(e.target).val(formatted)}}function handleCreditCardNumberChange(){}function cardTypeFromNumber(number){var re=new RegExp("^4");return null!=number.match(re)?"Visa":(re=new RegExp("^5[1-5]"),null!=number.match(re)?"Mastercard":(re=new RegExp("^3[47]"),null!=number.match(re)?"AMEX":(re=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)"),null!=number.match(re)?"Discover":(re=new RegExp("^36"),null!=number.match(re)?"Diners":(re=new RegExp("^30[0-5]"),null!=number.match(re)?"Diners - Carte Blanche":(re=new RegExp("^35(2[89]|[3-8][0-9])"),null!=number.match(re)?"JCB":(re=new RegExp("^(4026|417500|4508|4844|491(3|7))"),null!=number.match(re)?"Visa Electron":"")))))))}function setCardTypeIconFromNumber(number){switch(cardTypeFromNumber(number)){case"Visa Electron":case"Visa":setCardTypeIconAsVisa();break;case"Mastercard":setCardTypeIconAsMasterCard();break;case"AMEX":setCardTypeIconAsAmericanExpress();break;case"Discover":setCardTypeIconAsDiscover();break;case"Diners - Carte Blanche":case"Diners":setCardTypeIconAsDiners();break;case"JCB":setCardTypeIconAsJcb();break;default:clearCardTypeIcon()}}var settings,displayElement,cardNumberInput,KEY_0=48,KEY_9=57,KEY_DELETE=46,KEY_BACKSPACE=8,KEY_ARROW_LEFT=37,KEY_ARROW_DOWN=40,KEY_HOME=36,KEY_END=35,KEY_A=65,KEY_X=88,KEY_C=67,KEY_V=86,methods={init:function(options){return settings=$.extend({creditCardNumberMask:"XXXX XXXX XXXX XXXX",creditCardNumberPlaceholder:"Card number"},options),displayElement=this,initCardNumberInput(),cardNumberInput.detach(),this.empty(),setupCardNumberInput(),this}};$.fn.CardJs=function(methodOrOptions){return methods[methodOrOptions]?methods[methodOrOptions].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof methodOrOptions&&methodOrOptions?void $.error("Method "+methodOrOptions+" does not exist on jQuery.CardJs"):methods.init.apply(this,arguments)}}(jQuery),$(function(){$(".cardjs").CardJs()});